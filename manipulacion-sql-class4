USE MASTER
GO

IF DB_ID('SESION04') IS NOT NULL
DROP DATABASE SESION04
GO

CREATE DATABASE SESION04
GO

CREATE SCHEMA VENTASSS
GO

CREATE TABLE VENTASSS.EMPLEADO
(
	ID_EMPLEADO INT NOT NULL PRIMARY KEY,
	NOMBRE VARCHAR(25) NOT NULL,
	EDAD INT,
	EMAIL VARCHAR(25) NOT NULL
)
GO

INSERT INTO VENTASSS.EMPLEADO
VALUES
	(1,'LUIS ALBERTO SANCHEZ',45,'LUIS@GAMAIL.COM'),
	(2,'LUIS ALBERTO SANCHEZ',45,'LUIS@GAMAIL.COM'),
	(3,'LUIS ALBERTO SANCHEZ',45,'LUIS@GAMAIL.COM'),
	(4,'LUIS ALBERTO SANCHEZ',45,'LUIS@GAMAIL.COM'),
	(5,'LUIS ALBERTO SANCHEZ',45,'LUIS@GAMAIL.COM'),
	(6,'LUIS ALBERTO SANCHEZ',45,'LUIS@GAMAIL.COM'),
	(7,'LUIS ALBERTO SANCHEZ',45,'LUIS@GAMAIL.COM'),
	(8,'LUIS ALBERTO SANCHEZ',45,'LUIS@GAMAIL.COM')
GO

--LIKE, BETWEEN, IN, !, =, =<,>=, AND, OR; 
UPDATE VENTASSS.EMPLEADO 
SET 
	NOMBRE ='JAVIER CRUZ FLORES',
	EDAD = 19,
	EMAIL ='CRUZ@GMAIL.COM'
WHERE ID_EMPLEADO= 2
GO

SELECT * FROM VENTASSS.EMPLEADO
GO

-- Actualiza el correo a 'JAVIER@GMAIL.COM' donde el nombre del empleado inicie con J
UPDATE VENTASSS.EMPLEADO
	SET 
		EMAIL = 'JAVIER@GMAIL.COM'
WHERE NOMBRE LIKE 'J%';
--EL PORCENTAJE % ES LO QUE VENGA LUEGO, Y EL _ ES CUALQUIER DATO

SELECT * FROM VENTASSS.EMPLEADO;
-- Actualiza la edad a 19 donde el antepenúltimo carácter del apellido sea 'H'
UPDATE VENTASSS.EMPLEADO
SET 
	EDAD = 19
WHERE NOMBRE LIKE '%H__';
GO

SELECT * FROM VENTASSS.EMPLEADO;


--DELETE

DELETE  VENTASSS.EMPLEADO
WHERE ID_EMPLEADO = 4;
GO

USE VENTASCIB
GO

---SELECT 
--DISTINCT => VISUALIZAR LOS REGITROS PARA QUE NO SE REPITAN
SELECT DISTINCT EST_OCO FROM TB_ORDEN_COMPRA;
GO
---TOP => VISUALIZA LOS N PRIMEROS REGISTROS
SELECT TOP 3 * FROM TB_ORDEN_COMPRA
GO

--EJERCICIO
--LISTA LOS 3 PRIMEROS REGISTROS CUYO EST_OCO SEA MAYORES
SELECT TOP 3* FROM TB_ORDEN_COMPRA
ORDER BY EST_OCO DESC
GO

--LISTAR LOS ESTUDIANTES QUE ÉRTENEZCAN AL AQUINTO SUPERIOR DE LA TABLA
--VENDEDOR
--EL PERCER ES EL PORCENTAJE
SELECT TOP 33 PERCENT *  FROM TB_VENDEDOR
GO

--LISTA LOS PROVEDORES DEL DISTRITO DE BARRANCO
--SUB CONSULTAS
	SELECT * FROM TB_PROVEEDOR
	WHERE COD_DIS = (SELECT COD_DIS FROM TB_DISTRITO WHERE NOM_DIS='Barranco')
	GO
--METODO JOIN
SELECT p.* FROM TB_PROVEEDOR p
	JOIN TB_DISTRITO d ON p.COD_DIS = d.COD_DIS
WHERE d.NOM_DIS = 'Barranco';


--LISTA LOS PROVEDORES DEL DISTRITO BARRANCO, BELLAVISTA, Y LOS OLIVOS


SELECT * FROM TB_PROVEEDOR
WHERE COD_DIS in (SELECT COD_DIS FROM TB_DISTRITO WHERE NOM_DIS in ('Barranco','Bellavista','Los Olivos'))
GO

--AGRUPACIONES 
SELECT COD_PRO, MAX(CAN_PED) 'MAX CANTIDAD', MIN(CAN_PED) 'MIN CANTIDAD' FROM TB_DETALLE_COMPRA
GROUP BY COD_PRO
GO

